
<!DOCTYPE html>
<html lang="es-co">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="~/css/style.css" rel="stylesheet" />
	<link href="~/css/alerts.css" rel="stylesheet" />
    <link href="~/css/adminActualizarInfo.css" rel="stylesheet" />
    <link href="~/images/icono-web.webp" rel="icon" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel="stylesheet">
    <title>Proveedores USC</title>
</head>
<body>

    <main class="main-page-container">
        @Html.Partial("_NavAdmin")
        <section class="page-content">
            <div class="content-header">
                <h1>Actualizar información</h1>
            </div>
            <div class="content-body">
                <form id="uploadForm" enctype="multipart/form-data">
                    <div class="custom-input-group">
                        <label for="infoType">Tipo de Información</label>
                        <select id="infoType" name="infoType">
                            <option value="IVA">IVA</option>
                            <option value="ICA">ICA</option>
                            <option value="RTF">Retención en la Fuente</option>
                        </select>
                    </div>
                    <div class="mb-1" style="font-size:15px;font-weight:bold">
                        Subir archivo
                    </div>
                    <div class="upload-container" id="dropArea">
                        <svg xmlns="http://www.w3.org/2000/svg" width="75" height="75" fill="currentColor" class="bi bi-cloud-upload" viewBox="0 0 16 16" style="opacity:0.5;">
                            <path fill-rule="evenodd" d="M4.406 1.342A5.53 5.53 0 0 1 8 0c2.69 0 4.923 2 5.166 4.579C14.758 4.804 16 6.137 16 7.773 16 9.569 14.502 11 12.687 11H10a.5.5 0 0 1 0-1h2.688C13.979 10 15 8.988 15 7.773c0-1.216-1.02-2.228-2.313-2.228h-.5v-.5C12.188 2.825 10.328 1 8 1a4.53 4.53 0 0 0-2.941 1.1c-.757.652-1.153 1.438-1.153 2.055v.448l-.445.049C2.064 4.805 1 5.952 1 7.318 1 8.785 2.23 10 3.781 10H6a.5.5 0 0 1 0 1H3.781C1.708 11 0 9.366 0 7.318c0-1.763 1.266-3.223 2.942-3.593.143-.863.698-1.723 1.464-2.383" />
                            <path fill-rule="evenodd" d="M7.646 4.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1-.708.708L8.5 5.707V14.5a.5.5 0 0 1-1 0V5.707L5.354 7.854a.5.5 0 1 1-.708-.708z" />
                        </svg>
                        <p>Arrastre y suelte un archivo aquí <br>o</p>
						<input type="file" name="file" id="file" class="file-input" accept=".xls,.xlsx" />
                        <label for="file" class="file-label custom-button">
                            <svg class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
                                <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12V7.914a1 1 0 0 1 .293-.707l3.914-3.914A1 1 0 0 1 9.914 3H18a1 1 0 0 1 1 1v16a1 1 0 0 1-1 1H6a1 1 0 0 1-1-1v-4m5-13v4a1 1 0 0 1-1 1H5m0 6h9m0 0-2-2m2 2-2 2" />
                            </svg>


                            Examinar 
                        </label>
                        <p class="file-name" id="file-name">Ningún archivo seleccionado</p>
                    </div>
                    <div class="custom-btn-container">
                        <button type="submit" class="custom-button">
                            <svg class="w-6 h-6 text-gray-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
                                <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 15v2a3 3 0 0 0 3 3h10a3 3 0 0 0 3-3v-2M12 4v12m0-12 4 4m-4-4L8 8" />
                            </svg>

                            Subir
                            
                        </button>
                    </div>
                    
                </form>
            </div>
        </section>
    </main>
    <!--Alertas-->
    <div class="modal fade" id="alertSuccess" tabindex="-1" aria-labelledby="alertLabelSuccess" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-fullscreen-sm-down">
            <div class="modal-content alert-content-success shadow-lg rounded-4">
                <div class="modal-header alert-header-success">
                    <h1 class="modal-title alert-title fs-5" id="alertLabelSuccess">
                        <svg xmlns="http://www.w3.org/2000/svg" width="55" height="55" fill="currentColor" class="bi bi-check-circle-fill" viewBox="0 0 16 16">
                            <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0m-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z" />
                        </svg>
                    </h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body text-center">

                    <p id="alertSuccessBody" class="fs-5"></p>
                </div>
                <div class="modal-footer d-flex justify-content-center">
                    <button type="button" class="btn btn-success" data-bs-dismiss="modal">
                        Aceptar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="alertError" tabindex="-1" aria-labelledby="alertLabelError" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-fullscreen-sm-down">
            <div class="modal-content alert-content-error shadow-lg rounded-4">
                <div class="modal-header alert-header-error">
                    <h1 class="modal-title alert-title fs-5" id="alertLabelError">
                        <svg xmlns="http://www.w3.org/2000/svg" width="55" height="55" fill="currentColor" class="bi bi-x-circle-fill" viewBox="0 0 16 16">
                            <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0M5.354 4.646a.5.5 0 1 0-.708.708L7.293 8l-2.647 2.646a.5.5 0 0 0 .708.708L8 8.707l2.646 2.647a.5.5 0 0 0 .708-.708L8.707 8l2.647-2.646a.5.5 0 0 0-.708-.708L8 7.293z" />
                        </svg>
                    </h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body text-center">

                    <p id="alertErrorBody" class="fs-5"></p>
                </div>
                <div class="modal-footer d-flex justify-content-center">
                    <button type="button" class="btn btn-danger" data-bs-dismiss="modal">
                        Aceptar
                    </button>
                </div>
            </div>
        </div>
    </div>

     <div class="modal fade" id="alert" tabindex="-1" aria-labelledby="alertLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-fullscreen-sm-down">
            <div class="modal-content shadow-lg rounded-4">
                <div class="modal-header ">
                    <h1 class="modal-title fs-5" id="alertLabel">
                        <svg class="w-6 h-6 text-gray-800 dark:text-white" width="55" height="55" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
                            <path fill-rule="evenodd" d="M2 12C2 6.477 6.477 2 12 2s10 4.477 10 10-4.477 10-10 10S2 17.523 2 12Zm11-4a1 1 0 1 0-2 0v5a1 1 0 1 0 2 0V8Zm-1 7a1 1 0 1 0 0 2h.01a1 1 0 1 0 0-2H12Z" clip-rule="evenodd" />
                        </svg>

                    </h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body text-center">

                    <p id="alertBody" class="fs-5"></p>
                </div>
                <div class="modal-footer d-flex justify-content-center">
                    <button type="button" class="btn btn-primary" data-bs-dismiss="modal">
                        Aceptar
                    </button>
                </div>
            </div>
        </div>
    </div>
 
    <!--Elemento de carga-->
    <div class="loader-container" id="loader-container">
            <span class="loader"></span>
    </div>

    @Html.Partial("_Footer")
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        document.getElementById('uploadForm').addEventListener('submit', function (e) {
            e.preventDefault();
            var formData = new FormData(this);
            var loadingElement = document.getElementById('loader-container');
            loadingElement.style.display = 'flex';

            fetch('/Admin/UpdateCertificateInfo', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                loadingElement.style.display = 'none';
                var alertSuccesBody = document.getElementById('alertSuccessBody');
				var alertErrorBody = document.getElementById('alertErrorBody');
                if (data.message) {
                    alertSuccesBody.innerText = data.message;
                    var alertSuccess = new bootstrap.Modal(document.getElementById('alertSuccess'));
                    alertSuccess.show();
                } else if (data.error) {
                    alertErrorBody.innerText = data.error;
                    var alertError = new bootstrap.Modal(document.getElementById('alertError'));
					alertError.show();
                }  
            })
            .catch(error => {
                loadingElement.style.display = 'none';
                console.error('Error:', error);
            });
        });

		const dropArea = document.getElementById('dropArea');
		const fileInput = document.getElementById('file');
		const fileNameDisplay = document.getElementById('file-name');

		dropArea.addEventListener('dragover', (e) => {
            e.preventDefault();
			dropArea.classList.add('dragover');
        });

		dropArea.addEventListener('dragleave', () => {
			dropArea.classList.remove('dragover');
        });

		dropArea.addEventListener('drop', (e) => {
			e.preventDefault();
			dropArea.classList.remove('dragover');
			const file = e.dataTransfer.files[0];
            if(validateFile(file)){
				fileInput.files = e.dataTransfer.files;
				fileNameDisplay.innerText = file.name;
            }
		});

		fileInput.addEventListener('change', () => {
			const file = fileInput.files[0];
			if(validateFile(file)){
                fileNameDisplay.innerText = file.name;
            }else{
				fileInput.value = '';
            }
        });

		function validateFile(file){
            if(!file) return false;
            const allowedExtensions = ["xls","xlsx"];
			const fileExtension = file.name.split('.').pop();
			if(!allowedExtensions.includes(fileExtension)){
                const alertBody = document.getElementById('alertBody');
                var alert = new bootstrap.Modal(document.getElementById('alert'));
                alertBody.innerText = 'El archivo seleccionado no es válido';
                alert.show();
				return false;
            }
			return true;
        }
    </script>
</body>
</html>
